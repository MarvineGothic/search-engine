<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>jQuery UI Autocomplete - Multiple values</title>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="/resources/demos/style.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <!--<script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>-->
    <script src="code.js"></script>
    <link rel="stylesheet" href="style.css" />
    <script>

        $(document).ready(function() {
            var baseUrl = "http://localhost:8080";

            $("#searchbutton").click(function() {
                console.log("Sending request to server.");
                $.ajax({
                    method: "GET",
                    url: baseUrl + "/search",
                    data: {query: $('#searchbox').val()}
                }).success( function (data) {
                    console.log("Received response " + data);
                    $("#responsesize").html("<p>" + data.length + " websites retrieved</p>");
                    var buffer = "<ul>\n";
                    $.each(data, function(index, value) {
                        buffer += "<li><a href=\"" + value.url + "\">" + value.title + "</a></li>\n";
                    });
                    buffer += "</ul>";
                    $("#urllist").html(buffer);
                });
            });
            var _source = [];
            var availableTags = [
                "ActionScript",
                "AppleScript",
                "Asp",
                "BASIC",
                "C",
                "C++",
                "Clojure",
                "COBOL",
                "ColdFusion",
                "Erlang",
                "Fortran",
                "Groovy",
                "Haskell",
                "Java",
                "JavaScript",
                "Lisp",
                "Perl",
                "PHP",
                "Python",
                "Ruby",
                "Scala",
                "Scheme"
            ];
            function split( val ) {
                return val.split( /\s+/ );
            }
            function extractLast( term ) {
                return split( term ).pop();
            }

            $( "#searchbox" )
            // don't navigate away from the field on tab when selecting an item
                .on( "keydown", function( event ) {
                    if ( event.keyCode === $.ui.keyCode.TAB &&
                        $( this ).autocomplete( "instance" ).menu.active ) {
                        event.preventDefault();
                    }
                })
                .autocomplete({
                    minLength: 0,
                    // update `source` with `value` of `#dynsearch` ,
                    // on `change` event
                    change: function (event, ui) {
                        // insert `#dynsearch` `value` into `_search` (`source`) array
                        _source.splice(0, 0, event.target.value);
                        event.target.value = "";
                    },
                    /*source: _source*/
                    source: function( request, response ) {
                        // delegate back to autocomplete, but extract the last term
                        response( $.ui.autocomplete.filter(_source, extractLast( request.term ) ) );
                    },
                    focus: function() {
                        // prevent value inserted on focus
                        return false;
                    },
                    select: function( event, ui ) {
                        var terms = split( this.value );
                        // remove the current input
                        terms.pop();
                        // add the selected item
                        terms.push( ui.item.value );
                        // add placeholder to get the comma-and-space at the end
                        terms.push( "" );
                        this.value = terms.join(" ");
                        return false;
                    }
                });
        });

    </script>
</head>
<body>
<div id="content">
    <h1>My Search Engine</h1>
    <input id="searchbox" type="text" placeholder="Search here..." />
    <button id="searchbutton">Search</button>
</div>
<div id="responsesize">
</div>
<div id="urllist">
</div>
</body>
</html>